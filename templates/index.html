<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>OpenLH</title>
    <link rel="stylesheet" type="text/css" href="static/index.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Pacifico&display=swap"
        rel="stylesheet">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/509e18566b.js" crossorigin="anonymous"></script>

    <script src="static/js/index.js"></script>
    <script src="static/js/blockly_compressed.js"></script>
    <script src="static/js/blocks_compressed.js"></script>
    <script src="static/js/javascript_compressed.js"></script>
    <script src="static/js/python_compressed.js"></script>
    <script src="static/msg/js/en.js"></script>
    <script src="static/js/app.js"></script>
    <script src="static/js/wheelzoom.js"></script>

</head>

<body>

    <!-- NavBar -->
    <nav class="navbar navbar-dark bg-dark " style="box-shadow: 0px 10px 50px rgba(0, 0, 0, 0.4); background-color: #4B515D;">
        <a class="navbar-brand pacifico-font" href="#">OpenLH</a>
        <div>
            <img class="milab-logo" src="http://milab.idc.ac.il/wp-content/uploads/2017/04/milab-logo.png"
                class="d-inline-block align-top" alt="">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <a class="nav-item nav-link" href="" data-toggle="modal" data-target="#About">About</a>
                <a class="nav-item nav-link" href="https://www.instructables.com/id/OpenLH/">Instructables Page</a>
                <a class="nav-item nav-link" href="https://github.com/idc-milab/openlh"><i
                        class="fa fa-trash\"></i>GitHub</a>
                <a class="nav-item nav-link"
                    href="http://milab.idc.ac.il/wp-content/uploads/2019/01/OpenLH.pdf">Publication</a>
            </div>
        </div>
        <!-- About Modal -->
        <div class="modal fade" id="About">
            <div class="modal-dialog">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">Why did we build this?</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <img class="modal-image" src="static/jpg/about.jpg" height="250" width="350"></img>
                        <br>
                        <p>Liquid handling robots are robots that can move liquids with high accuracy allowing to
                            conduct
                            high throughput experiments such as large scale screenings, bioprinting and execution of
                            different protocols in molecular microbiology without a human hand, most liquid handling
                            platforms are limited to standard protocols.
                        </p>
                        <p>
                            The OpenLH is based on an open source robotic arm (uArm Swift Pro) and allows creative
                            exploration. With the decrease in cost of accurate robotic arms we wanted to create a liquid
                            handling robot that will be easy to assemble, made by available components, will be as
                            accurate
                            as gold standard and will cost just around 1000$. In addition the OpenLH is extendable,
                            meaning
                            more features can be added such as a camera for image analysis and real time decision making
                            or
                            setting the arm on a linear actuator for a wider range. In order to control the arm we made
                            a
                            simple blockly interface and a picture to print interface block for bioprinting images.
                        </p>
                        <p>
                            We wanted to build a tool that would be used by students, bioartists, biohackers and
                            community
                            biology labs around the world.
                        </p>
                        <p>
                            We hope more innovation can emerge using the OpenLH in low resource settings.</p>
                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>

    </nav>
    <!-- Buttons line -->
    <div style="margin-top: 20px; margin-left: 5px">
        <button class="btn btn-secondary" onclick="showCode()" id="ShowCode" style="margin:3px;">
            Show Code
        </button>
        <!-- <button class="btn btn-success" onclick="runCode()" id="RunJavaScript" style="margin:3px;">Run JavaScript
        </button> -->
        <div class="btn-group" role="group" aria-label="Basic example">
            <button class="btn btn-success" onclick="runWorkspaceCode()" id="Play"
                style="margin-left:3px; margin-right:0px;">
                Run with OpenLH
            </button>
            <button class="btn btn-danger" onclick="abort()" id="Abort" style="margin-right:3px;">
                Abort
            </button>
        </div>

        <div class="btn-group" role="group" aria-label="Basic example">
            <button class="btn btn-secondary" onclick="savePosition()" id="SavePosition" style="margin-left:5px">Manual
                Sampling
            </button>
            <button class="btn btn-secondary" onclick="addPositionBlock()" disabled="true" id="Add">Add Block
            </button>
            <button class="btn btn-secondary" onclick="stopSavePosition()" disabled="true" id="Stop">Finish
            </button>
        </div>

        <!-- Button to Open the Image Modal -->
        <button type="button" id="imageModalButton"
            class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab" data-toggle="modal"
            data-target="#imageUploadModal" style="margin-left:15px;" title="Upload an Image">
            <i class="fa fa-upload"></i>
        </button>

        <!-- Button to create cellular automaton program -->
        <button type="button" id="cellularAutomatonButton"
            class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab" data-toggle="modal"
            data-target="#cellularAutomataModal" style="margin-left:6px;" title="Cellular Automaton">
            <i class="fab fa-firstdraft"></i>
        </button>

        <!-- Button to Open the Saved program Modal -->
        <button type="button" id="savedProgramButton"
            class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab" data-toggle="modal"
            data-target="#saveProgramModal" style="margin-left:6px;" title="Save Program">
            <i class="far fa-save"></i>
        </button>

        <!-- Button to clear the workspace -->
        <button type="button" id="cleanWorkspaceButton"
            class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab" style="margin-left:6px;"
            title="Clear Workspace" data-toggle="modal" data-target="#clearWorkspaceModal">
            <i class="far fa-trash-alt"></i>
        </button>


        <!-- Image Upload Modal -->
        <div class="modal fade" id="imageUploadModal">
            <div class="modal-dialog">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">Upload an image</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <img class="modal-image" src="static/jpg/upload.jpg" height="160" width="300"></img>
                        <br>
                        <p> Create visual art using live bacteria as bio-ink. Load a PNG picture, then add a 'print
                            image' block from the image section of the toolbox. All uploaded images will appear on the
                            'Printing Patterns' section.
                        </p>
                        <form action="/upload" method="post" enctype="multipart/form-data">
                            <div class="input-group mb-3">
                                <div class="custom-file">
                                    <input type="file" class="custom-file-input" id="fileInputOnUploadModal"
                                        accept="image/png" name="image">
                                    <label class="custom-file-label" for="fileInputOnUploadModal">Choose file</label>
                                </div>
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="submit" id="UploadButtonUploadModal"
                                        disabled>Upload</button>
                                </div>
                            </div>
                        </form>
                        <p><b>--- Upload your image in .png format ---</b></p>
                        <!-- <form action="/upload" method="post" enctype="multipart/form-data">
                            <span class="btn btn-default btn-file">
                                Browse <input type="file" name="image" accept="image/png">
                            </span>
                            <input type="submit" value="Upload">
                        </form> -->
                        <p></p>

                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>

        <!-- Cellular Automata Modal -->
        <div class="modal fade" id="cellularAutomataModal">
            <div class="modal-dialog">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">Generate a Cellular Automaton Pattern</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <p> Create beautifull printing patterns based on elementary cellular automaton rules. All
                            created
                            patterns will appear on the 'Printing Patterns' section.
                        </p>
                        <div class="column">
                            <form action="/ca_generate" method="post" enctype="multipart/form-data"
                                id="cellularAutomatonForm">
                                <div class="input-group mb-3" style="margin-top: 10px;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Initial state mode</span>
                                    </div>
                                    <select name="mode">
                                        <option value="N">Normal</option>
                                        <option value="R">Random</option>
                                    </select>
                                </div>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Rule</span>
                                    </div>
                                    <input type="number" name="rule" id="ruleNumber" class="form-control"
                                        placeholder="(0-255)" aria-describedby="basic-addon2" min="1" max="255"
                                        required>
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button" id="ruleNumber"
                                            onclick="changePreviewImageOnModal()">Preview</button>
                                    </div>
                                </div>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Number of steps</span>
                                    </div>
                                    <input type="number" name="steps" id="numOfSteps" class="form-control"
                                        placeholder="" aria-describedby="basic-addon2" min="1" required>
                                </div>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Pattern name</span>
                                    </div>
                                    <input type="text" name="name" id="patternName" class="form-control" placeholder=""
                                        aria-describedby="basic-addon2" required>
                                </div>
                        </div>
                        <p></p>
                        <div class="column">
                            <!-- <br> -->
                            <img id="previewImage" class="modal-preview-Image rounded zoom"
                                src="static/jpg/cellular_automaton.jpg" height="200" width="200" data-toggle="tooltip"
                                title="Use the mouse wheel to zoom!" data-placement="bottom"></img>
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-primary" value="Generate" name="form[Submit]" id="Submit">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Save Program Modal -->
        <div class="modal fade" id="saveProgramModal">
            <div class="modal-dialog">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">Save Program</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal body -->
                    <div class="modal-body">
                        <p> You can save your blockly programs for later use. All saved programs will appear on the
                            'Saved Programs' section.</p>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Name</span>
                            </div>
                            <div>
                                <input type="text" name="programName" id="programName" class="form-control"
                                    placeholder="your program name" aria-label="Recipient's username"
                                    aria-describedby="basic-addon2" style="width: 200px;">
                            </div>
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button" id="Save"
                                    onclick="saveWorkspace()" data-dismiss="modal">Save</button>
                            </div>
                        </div>
                        <!-- <label for="programName">Name:</label>
                        <input type="text" name="programName" id="programName">
                        <button onclick="saveWorkspace()" data-dismiss="modal">Save</button> -->
                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>

        <!--Clear Workspace Modal -->
        <div class="modal fade" tabindex="-1" role="dialog" id="clearWorkspaceModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Clear Workspace</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>You are about to clear your blockly workspace, this procedure is irreversible. Note that
                            you can save your program for later use using the <b>Save Program</b> feature.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-danger" onclick="cleanWorkspace()"
                            data-dismiss="modal">Discard changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Blockly -->
    <div id="blocklyDiv"></div>

    <!-- Tabs - saved programs, uploaded images and cellular automaton patterns -->
    <div id="tabs">

        <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
            <div class="mdl-tabs__tab-bar">
                <a href="#programs-panel" class="mdl-tabs__tab is-active tabs-header-font">Saved Programs</a>
                <a href="#images-panel" class="mdl-tabs__tab tabs-header-font">Printing Patterns</a>
            </div>
            <div class="mdl-tabs__panel is-active" id="programs-panel">
                <ul id="listOfPrograms" class='mdl-list'>
                </ul>
            </div>
            <div class="mdl-tabs__panel" id="images-panel" style="background-color: #f2f2f2;">
                <span class="badge badge-pill badge-secondary" style="margin: 12px; font-size: 15px;">Uploaded
                    Images</span>
                <ul id="listOfImages" class="'mdl-list">
                </ul>
                <span class="badge badge-pill badge-secondary"
                    style="margin-left: 12px; margin-bottom: 12px; font-size: 15px;">Cellular
                    Automaton Patterns</span>
                <ul id="listOfCellularAutomatonPatterns" class="'mdl-list"></ul>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="page-footer font-small"
        style="box-shadow: 0px 10px 50px rgba(0, 0, 0, 0.3); background-color: #4B515D;">
        <!-- Copyright -->
        <div class="footer-copyright text-center py-3"
            style="color: white; box-shadow: 0px 10px 50px rgba(0, 0, 0, 0.5);">Â© 2020 Copyright:
            <a href="http://milab.idc.ac.il/" class="text-white"> miLAB.idc.ac.il</a>
        </div>
        <!-- Copyright -->
    </footer>

    <!-- XMLs -->
    <xml xmlns="http://www.w3.org/1999/xhtml" id="toolbox" style="display: none;">
        <category name="Robot" colour=250 style="font-family: Georgia, 'Times New Roman', Times, serif;">
            <block type="robot_move"></block>
            <block type="robot_move_relative"></block>
            <block type="pick_or_drop_pipette"></block>
            <block type="robot_speed">
                <value name="speed">
                    <shadow type="math_number">
                        <field name="NUM">10000</field>
                    </shadow>
                </value>
            </block>
            <block type="load_Material">
                <value name="amount">
                    <shadow type="math_number">
                        <field name="NUM">30</field>
                    </shadow>
                </value>
            </block>
            </block>
            <block type="robot_wrist"></block>
            <block type="robot_pump"></block>
            <block type="robot_sleep"></block>
        </category>
        <category name="Coordinates" colour=270>
            <block type="robot_position_location_only"></block>
            <block type="robot_position_new"></block>
            <block type="robot_position"></block>
            <!-- <block type="robot_position_arithmetic"></block> -->
            <block type="robot_position_arithmetic_puzzle">
                <value name="X">
                    <shadow type="math_number">
                        <field name="NUM">0</field>
                    </shadow>
                </value>
                <value name="Y">
                    <shadow type="math_number">
                        <field name="NUM">0</field>
                    </shadow>
                </value>
                <value name="Z">
                    <shadow type="math_number">
                        <field name="NUM">0</field>
                    </shadow>
                </value>
            </block>
            <block type="robot_position_current"></block>
        </category>
        <category name="BioPrint" colour="#993DFF">
            <block type="print_pattern_mini"></block>
            <block type="print_pattern"></block>
        </category>
        <category name="Modules (beta)" colour="#808080">
            <block type="shaker_module"></block>
            <block type="heater_module"></block>
            <!-- <block type="materials"></block> -->
        </category>
        <sep></sep>
        <category name="Logic" colour="#5C81A6">
            <block type="controls_if"></block>
            <block type="logic_compare">
                <field name="OP">EQ</field>
            </block>
            <block type="logic_operation">
                <field name="OP">AND</field>
            </block>
            <block type="logic_negate"></block>
            <block type="logic_boolean">
                <field name="BOOL">TRUE</field>
            </block>
            <block type="logic_null"></block>
            <block type="logic_ternary"></block>
        </category>
        <category name="Loops" colour="#5CA65C">
            <block type="controls_repeat_ext">
                <value name="TIMES">
                    <shadow type="math_number">
                        <field name="NUM">10</field>
                    </shadow>
                </value>
            </block>
            <block type="controls_whileUntil">
                <field name="MODE">WHILE</field>
            </block>
            <block type="controls_for">
                <field name="VAR" id="U{ZeRYdWs1|!g]Qryiw(" variabletype="">i</field>
                <value name="FROM">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="TO">
                    <shadow type="math_number">
                        <field name="NUM">10</field>
                    </shadow>
                </value>
                <value name="BY">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
            </block>
            <block type="controls_forEach">
                <field name="VAR" id="TFhZ%uLyA,;JW@x3+Csb" variabletype="">j</field>
            </block>
            <block type="controls_flow_statements">
                <field name="FLOW">BREAK</field>
            </block>
        </category>
        <category name="Math" colour="#5C68A6">
            <block type="math_number">
                <field name="NUM">0</field>
            </block>
            <block type="math_arithmetic">
                <field name="OP">ADD</field>
                <value name="A">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="B">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
            </block>
            <block type="math_single">
                <field name="OP">ROOT</field>
                <value name="NUM">
                    <shadow type="math_number">
                        <field name="NUM">9</field>
                    </shadow>
                </value>
            </block>
            <block type="math_trig">
                <field name="OP">SIN</field>
                <value name="NUM">
                    <shadow type="math_number">
                        <field name="NUM">45</field>
                    </shadow>
                </value>
            </block>
            <block type="math_constant">
                <field name="CONSTANT">PI</field>
            </block>
            <block type="math_number_property">
                <mutation divisor_input="false"></mutation>
                <field name="PROPERTY">EVEN</field>
                <value name="NUMBER_TO_CHECK">
                    <shadow type="math_number">
                        <field name="NUM">0</field>
                    </shadow>
                </value>
            </block>
            <block type="math_round">
                <field name="OP">ROUND</field>
                <value name="NUM">
                    <shadow type="math_number">
                        <field name="NUM">3.1</field>
                    </shadow>
                </value>
            </block>
            <block type="math_on_list">
                <mutation op="SUM"></mutation>
                <field name="OP">SUM</field>
            </block>
            <block type="math_modulo">
                <value name="DIVIDEND">
                    <shadow type="math_number">
                        <field name="NUM">64</field>
                    </shadow>
                </value>
                <value name="DIVISOR">
                    <shadow type="math_number">
                        <field name="NUM">10</field>
                    </shadow>
                </value>
            </block>
            <block type="math_constrain">
                <value name="VALUE">
                    <shadow type="math_number">
                        <field name="NUM">50</field>
                    </shadow>
                </value>
                <value name="LOW">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="HIGH">
                    <shadow type="math_number">
                        <field name="NUM">100</field>
                    </shadow>
                </value>
            </block>
            <block type="math_random_int">
                <value name="FROM">
                    <shadow type="math_number">
                        <field name="NUM">1</field>
                    </shadow>
                </value>
                <value name="TO">
                    <shadow type="math_number">
                        <field name="NUM">100</field>
                    </shadow>
                </value>
            </block>
            <block type="math_random_float"></block>
        </category>
        <!-- <category name="Text" colour="#5CA68D">
            <block type="text">
                <field name="TEXT"></field>
            </block>
            <block type="text_join">
                <mutation items="2"></mutation>
            </block>
            <block type="text_append">
                <field name="VAR" id="qGz2wOv8)!Ofx;?M@v/^" variabletype="">item</field>
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT"></field>
                    </shadow>
                </value>
            </block>
            <block type="text_length">
                <value name="VALUE">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_isEmpty">
                <value name="VALUE">
                    <shadow type="text">
                        <field name="TEXT"></field>
                    </shadow>
                </value>
            </block>
            <block type="text_indexOf">
                <field name="END">FIRST</field>
                <value name="VALUE">
                    <block type="variables_get">
                        <field name="VAR" id="F*)#1)lRV~YRv~GgdERT" variabletype="">text</field>
                    </block>
                </value>
                <value name="FIND">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_charAt">
                <mutation at="true"></mutation>
                <field name="WHERE">FROM_START</field>
                <value name="VALUE">
                    <block type="variables_get">
                        <field name="VAR" id="F*)#1)lRV~YRv~GgdERT" variabletype="">text</field>
                    </block>
                </value>
            </block>
            <block type="text_getSubstring">
                <mutation at1="true" at2="true"></mutation>
                <field name="WHERE1">FROM_START</field>
                <field name="WHERE2">FROM_START</field>
                <value name="STRING">
                    <block type="variables_get">
                        <field name="VAR" id="F*)#1)lRV~YRv~GgdERT" variabletype="">text</field>
                    </block>
                </value>
            </block>
            <block type="text_changeCase">
                <field name="CASE">UPPERCASE</field>
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_trim">
                <field name="MODE">BOTH</field>
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_print">
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
            <block type="text_prompt_ext">
                <mutation type="TEXT"></mutation>
                <field name="TYPE">TEXT</field>
                <value name="TEXT">
                    <shadow type="text">
                        <field name="TEXT">abc</field>
                    </shadow>
                </value>
            </block>
        </category> -->
        <category name="Lists" colour="#745CA6">
            <block type="lists_create_with">
                <mutation items="0"></mutation>
            </block>
            <block type="lists_create_with">
                <mutation items="3"></mutation>
            </block>
            <block type="lists_repeat">
                <value name="NUM">
                    <shadow type="math_number">
                        <field name="NUM">5</field>
                    </shadow>
                </value>
            </block>
            <block type="lists_length"></block>
            <block type="lists_isEmpty"></block>
            <block type="lists_indexOf">
                <field name="END">FIRST</field>
                <value name="VALUE">
                    <block type="variables_get">
                        <field name="VAR" id="?#8~*L0D}=H$n~5ipzLZ" variabletype="">list</field>
                    </block>
                </value>
            </block>
            <block type="lists_getIndex">
                <mutation statement="false" at="true"></mutation>
                <field name="MODE">GET</field>
                <field name="WHERE">FROM_START</field>
                <value name="VALUE">
                    <block type="variables_get">
                        <field name="VAR" id="?#8~*L0D}=H$n~5ipzLZ" variabletype="">list</field>
                    </block>
                </value>
            </block>
            <block type="lists_setIndex">
                <mutation at="true"></mutation>
                <field name="MODE">SET</field>
                <field name="WHERE">FROM_START</field>
                <value name="LIST">
                    <block type="variables_get">
                        <field name="VAR" id="?#8~*L0D}=H$n~5ipzLZ" variabletype="">list</field>
                    </block>
                </value>
            </block>
            <block type="lists_getSublist">
                <mutation at1="true" at2="true"></mutation>
                <field name="WHERE1">FROM_START</field>
                <field name="WHERE2">FROM_START</field>
                <value name="LIST">
                    <block type="variables_get">
                        <field name="VAR" id="?#8~*L0D}=H$n~5ipzLZ" variabletype="">list</field>
                    </block>
                </value>
            </block>
            <block type="lists_split">
                <mutation mode="SPLIT"></mutation>
                <field name="MODE">SPLIT</field>
                <value name="DELIM">
                    <shadow type="text">
                        <field name="TEXT">,</field>
                    </shadow>
                </value>
            </block>
            <block type="lists_sort">
                <field name="TYPE">NUMERIC</field>
                <field name="DIRECTION">1</field>
            </block>
        </category>
        <!-- <category name="Colour" colour="#A6745C">
            <block type="colour_picker">
                <field name="COLOUR">#ff0000</field>
            </block>
            <block type="colour_random"></block>
            <block type="colour_rgb">
                <value name="RED">
                    <shadow type="math_number">
                        <field name="NUM">100</field>
                    </shadow>
                </value>
                <value name="GREEN">
                    <shadow type="math_number">
                        <field name="NUM">50</field>
                    </shadow>
                </value>
                <value name="BLUE">
                    <shadow type="math_number">
                        <field name="NUM">0</field>
                    </shadow>
                </value>
            </block>
            <block type="colour_blend">
                <value name="COLOUR1">
                    <shadow type="colour_picker">
                        <field name="COLOUR">#ff0000</field>
                    </shadow>
                </value>
                <value name="COLOUR2">
                    <shadow type="colour_picker">
                        <field name="COLOUR">#3333ff</field>
                    </shadow>
                </value>
                <value name="RATIO">
                    <shadow type="math_number">
                        <field name="NUM">0.5</field>
                    </shadow>
                </value>
            </block>
        </category> -->
        <sep></sep>
        <category name="Variables" colour="#A65C81" custom="VARIABLE"></category>
        <category name="Functions" colour="#9A5CA6" custom="PROCEDURE"></category>
    </xml>

    <xml id="startBlocks" style="display: none">
        <block type="robot_move" id="lQfs928Y2laRna,e}JHL" x="44" y="32">
            <value name="position">
                <block type="robot_position_new" id="R#={M)J=Y[Wz|)T=wsck">
                    <field name="X">0</field>
                    <field name="Y">0</field>
                    <field name="Z">0</field>
                </block>
            </value>
        </block>
    </xml>


    <script>

        // jQuerys

        // clear all input values when loading the page
        $(window).on('load', function () {
            $('#UploadButtonUploadModal').attr('disabled', true);
            $('#programName').val('');
            $('#ruleNumber').val('');
            $('#numOfSteps').val('');
            $('#patternName').val('');
        });

        // on image upload modal, show file name after browsing 
        $('#fileInputOnUploadModal').on('change', function () {
            //get the file name
            var fileName = $(this).val();
            var cleanFileName = fileName.replace('C:\\fakepath\\', " ");
            //replace the "Choose a file" label
            $(this).next('.custom-file-label').html(cleanFileName);
        })

        // allow uploading an image only when a png exist
        $('input[type=file]').change(function () {
            if ($('input[type=file]').val() == '') {
                $('#UploadButtonUploadModal').attr('disabled', true);
            }
            else {
                $('#UploadButtonUploadModal').attr('disabled', false);
            }
        })

        // allow saving a program only when a program name exists
        $("#Save").prop('disabled', true);
        var saveProgramModalFieldsToValidate = jQuery('#programName'),
            valid = false;
        saveProgramModalFieldsToValidate.keyup(function () {
            if (jQuery(this).val().length > 0) {
                jQuery(this).data('valid', true);
            } else {
                jQuery(this).data('valid', false);
            }
            saveProgramModalFieldsToValidate.each(function () {
                if (jQuery(this).data('valid') == true) {
                    valid = true;
                } else {
                    valid = false;
                }
            });
            if (valid === true) {
                jQuery("#Save").prop('disabled', false);
            } else {
                jQuery("#Save").prop('disabled', true);
            }
        });

        // init the Blockly workspace
        let demoWorkspace = Blockly.inject('blocklyDiv',
            {
                toolbox: document.getElementById('toolbox')
            });

        // load starting blocks
        Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),
            demoWorkspace);

        // load saved programs and uploaded images lists (to the tabs at the bottom)
        document.addEventListener("DOMContentLoaded", function (event) {
            getPrograms();
            getImages();
            getCellularAutomatonPatterns();
        });

        // enable zoom for preview image on cellular automaton modal
        wheelzoom(document.querySelector('img.zoom'));


        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });

    </script>

</body>

</html>